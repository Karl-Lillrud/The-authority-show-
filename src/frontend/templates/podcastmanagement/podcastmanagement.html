{% extends "components/base.html" %} {% block title %}Podcast Management{%
  endblock %} {% block content %}
  <head>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/components/sidebar.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/podcastmanagement/podcastmanagement.css') }}"
    />
  
    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-PTPQQ5WSQV"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
  
      gtag("config", "G-PTPQQ5WSQV");
    </script>
  </head>
  
  <div class="app-container">
    <!-- Sidebar -->
    <div id="sidebar-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <!-- Intentionally left empty as in teams -->
      </div>
      <div class="sidebar-content">
        <nav class="sidebar-menu">
          <ul>
            <li class="sidebar-menu-item">
              <a href="/dashboard" class="sidebar-menu-link dashboard-link">
                <span id="back-to-dashboard-icon" class="sidebar-icon"></span>
                <span>Back to Dashboard</span>
              </a>
            </li>
            <li class="sidebar-menu-item active">
              <a href="/podcastmanagement"  class="sidebar-menu-link">
                <span id="podcasts-icon" class="sidebar-icon"></span>
                <span>Podcasts</span>
              </a>
            </li>
  
            <li class="sidebar-menu-item hide-sidebar-menu-item">
              <a href="#" class="sidebar-menu-link">
                <span id="episodes-icon" class="sidebar-icon"></span>
                <span>Episodes</span>
              </a>
            </li>
            <li class="sidebar-menu-item hide-sidebar-menu-item">
              <a href="#" class="sidebar-menu-link" id="guests-link">
                <span id="guests-icon" class="sidebar-icon"></span>
                <span>Guests</span>
              </a>
            </li>
          </ul>
        </nav>
  
        <!-- Add action buttons section to sidebar -->
        <div class="sidebar-action-buttons">
          <h3>Actions</h3>
          <button id="add-podcast-btn" class="sidebar-action-button">
            <span id="add-icon-podcast" class="sidebar-icon"></span>
            <span>Add Podcast</span>
          </button>
          <button id="create-episode-btn" class="sidebar-action-button">
            <span id="add-icon-episode" class="sidebar-icon"></span>
            <span>Create Episode</span>
          </button>
          <button id="add-guest-btn" class="sidebar-action-button">
            <span id="add-icon-guest" class="sidebar-icon"></span>
            <span>Add Guest</span>
        </div>
      </div>
      <div class="sidebar-footer">
        <div class="sidebar-actions">
          <button id="toggle-sidebar" class="sidebar-toggle">
            <span id="toggle-sidebar-icon"></span>
          </button>
        </div>
      </div>
    </aside>
    </div>
  
    <!-- Main Content -->
    <main class="main-content">
      <!-- Podcast List -->
      <div id="podcast-list" class="podcast-list"></div>
  
      <!-- Podcast Detail -->
      <div id="podcast-detail" class="podcast-detail" style="display: none"></div>
  
      <!-- Form popup container for adding/updating a podcast -->
      {% include "podcastmanagement/form_popup.html" %}
  
      <!-- Form popup container for creating a new episode -->
      <div id="episode-form-popup" class="popup" style="display: none">
        <div class="form-box">
          <span id="close-episode-form-popup" class="close-btn">&times;</span>
          <h2 class="form-title">Create New Episode</h2>
          <form id="create-episode-form">
            <div class="form-grid">
              <div class="field-group full-width">
                <label for="podcast-select">Select Podcast</label>
                <select id="podcast-select" name="podcastId" required></select>
              </div>
              <div class="field-group full-width">
                <label for="episode-title">Episode Title</label>
                <input type="text" id="episode-title" name="title" required />
              </div>
              <div class="field-group full-width">
                <label for="episode-description">Description</label>
                <textarea
                  id="episode-description"
                  name="description"
                  rows="3"
                ></textarea>
              </div>
              <div class="field-group">
                <label for="publish-date">Publish Date</label>
                <input
                  type="datetime-local"
                  id="publish-date"
                  name="publishDate"
                  required
                />
              </div>
          <div class="field-group">
            <label for="duration">Duration (minutes)</label>
            <input type="number" id="duration" name="duration" min="0" required />
          </div>
          <div class="field-group">
            <label for="status">Status</label>
            <select id="status" name="status">
              <option value="Not Recorded" selected>Not Recorded</option>
              <option value="Published">Published</option>
              <option value="Recorded">Recorded</option>
              <option value="Edited">Edited</option>
              <option value="Not Scheduled">Not Scheduled</option>
            </select>
          </div>
          <div class="field-group">
            <label for="recording-at">Recording Date</label>
            <input type="datetime-local" id="recording-at" name="recordingAt" />
          </div>
        </div>
        <!-- Align buttons to the far right -->
        <div class="form-actions" style="text-align: right;">
          <button type="button" id="cancel-episode-form-btn" class="cancel-btn">Cancel</button>
          <button type="submit" class="save-btn">Create Episode</button>
          </div>
        </form>
      </div>
    </div>
 
      <!-- Highlight Editing Form -->
      <div id="highlight-form-popup" class="popup" style="display: none">
        <div class="form-box">
          <span id="close-highlight-form-popup" class="close-btn">&times;</span>
          <h2 class="form-title">Edit Highlight</h2>
          <form id="edit-highlight-form">
            <div class="field-group full-width">
              <label for="highlight-title">Highlight Title</label>
              <input type="text" id="highlight-title" name="title" required />
            </div>
            <div class="field-group full-width">
              <label for="highlight-start-time">Start Time (seconds)</label>
              <input
                type="number"
                id="highlight-start-time"
                name="startTime"
                required
              />
            </div>
            <div class="field-group full-width">
              <label for="highlight-end-time">End Time (seconds)</label>
              <input
                type="number"
                id="highlight-end-time"
                name="endTime"
                required
              />
            </div>
            <div class="form-actions">
              <button
                type="button"
                id="cancel-highlight-form-btn"
                class="cancel-btn"
              >
                Cancel
              </button>
              <button type="submit" class="save-btn">Save Highlight</button>
            </div>
          </form>
        </div>
      </div>
  
      <!-- New popup container for adding a guest -->
      <div id="guest-popup" class="popup" style="display: none">
        <div class="form-box">
          <span id="close-guest-popup" class="close-btn">&times;</span>
          <h2 class="form-title">Add Guest</h2>
          <form id="add-guest-form">
            <div class="field-group full-width">
              <label for="podcast-select-guest">Select Podcast</label>
              <select
                id="podcast-select-guest"
                name="podcastId"
                required
              ></select>
            </div>
            <div class="field-group full-width">
              <label for="episode-id">Episode ID</label>
              <select id="episode-id" name="episodeId" required></select>
            </div>
            <div class="field-group full-width">
              <label for="guest-name">Guest Name</label>
              <input type="text" id="guest-name" name="guestName" required />
            </div>
            <div class="field-group full-width">
              <label for="guest-description">Guest Description</label>
              <input
                type="text"
                id="guest-description"
                name="guestDescription"
                required
              />
            </div>
            <div class="field-group full-width">
              <label for="guest-areas">Areas of Interest (comma separated)</label>
              <input type="text" id="guest-areas" name="guestAreas" />
            </div>
            <div class="field-group full-width">
              <label for="guest-email">Email</label>
              <input type="email" id="guest-email" name="guestEmail" required />
            </div>
            <div class="form-actions">
              <button type="button" id="cancel-guest-btn" class="cancel-btn">
                Cancel
              </button>
              <button type="submit" class="save-btn">Add Guest</button>
            </div>
          </form>
        </div>
      </div>

      <div id="email-config-popup" class="popup" style="display: none">
        <div class="form-box">
          <span id="close-email-config-popup" class="close-btn">&times;</span>
          <h2 class="form-title">Email Configuration</h2>
          <div class="form-grid">
            <!-- Section for managing triggers -->
            <h3 class="section-title">Manage Triggers</h3>
            <div class="field-group full-width">
              <label for="trigger-select">Select Trigger</label>
              <select id="trigger-select" name="trigger">
                <option value="" disabled selected>Select a trigger to configure</option> <!-- Placeholder option -->
                <option value="booking">Booking</option>
                <option value="preparation">Preparation</option>
                <option value="missing_info">Missing Info</option>
                <option value="publishing_reminder">Publishing Reminder</option>
                <option value="join_link">Join Link</option>
                <option value="thank_you">Thank You</option>
                <option value="recommendations">Recommendations</option>
                <option value="suggestions">Suggestions</option>
                <option value="missing_social_media">Missing Social Media</option>
              </select>
            </div>
            <div id="trigger-info-box" class="trigger-info-box">
              <!-- Current configuration will be dynamically loaded here -->
            </div>
            <div class="field-group full-width">
              <label for="trigger-time">Trigger Time</label>
              <input type="number" id="trigger-time" name="triggerTime" placeholder="Enter time in hours" />
            </div>
            <button id="save-trigger-btn" class="save-btn">Save Trigger</button>
          </div>
  
          <!-- Outbox Section -->
          <div id="outbox-section" class="outbox-section">
            <h3 class="section-title">Outbox</h3>
            <div id="outbox-list" class="outbox-list">
              <!-- Outbox emails will be dynamically populated here -->
            </div>
          </div>s
  
          <div class="form-actions">
            <button id="close-email-config-btn" class="cancel-btn">Close</button>
          </div>
        </div>
      </div>

    <div id="episode-limit-popup" class="popup" style="display: none;">
      <div class="form-box">
        <h2 class="form-title">Episode Limit Reached</h2>
        <p>You have reached your episode limit. Buy more slots to create additional episodes.</p>
        <div class="form-actions">
          <button class="cancel-btn" id="close-limit-popup">Cancel</button>
          <button class="save-btn" id="buy-credits-btn-popup">Buy Credits</button>
        </div>
      </div>
    </div>
    </main>
  </div>
  
  <script
    type="module"
    src="{{ url_for('static', filename='js/components/sidebar.js') }}"
  ></script>
  <script
    type="module"
    src="{{ url_for('static', filename='js/podcastmanagement/podcastmanagement.js') }}"
  ></script>
  <script 
    type="module"
    src="{{ url_for('static', filename='js/podcastmanagement/emailconfig-functions.js') }}"
  ></script>
{% endblock %}

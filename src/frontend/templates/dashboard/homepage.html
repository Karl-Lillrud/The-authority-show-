<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/homepage.css') }}"
/>
<header>
  <h1>Select a Podcast:</h1>
</header>
<div class="container" id="podcast-list">
  <!-- Dynamically populated podcasts -->
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    fetch("/get_podcasts")
      .then((response) => response.json())
      .then((data) => {
        // data should have the shape: { podcast: [...] }
        if (data.error) {
          document.getElementById("podcast-list").innerHTML = `<p>${data.error}</p>`;
          return;
        }

        const podcasts = data.podcast || [];
        // If only 0 or 1 podcast, hide popup / skip logic
        if (podcasts.length <= 1) {
          // Example: just hide popup or auto-redirect, etc.
          // window.parent.document.getElementById('homepage-popup').style.display = 'none';
          return;
        }

        // Otherwise, build your podcast cards
        const podcastList = document.getElementById("podcast-list");
        podcastList.innerHTML = "";

        podcasts.forEach((pod) => {
          let podcastCard = document.createElement("div");
          podcastCard.classList.add("card");

          // Example image fallback if none
          let imgUrl = pod.image_url || "https://via.placeholder.com/150";

          podcastCard.innerHTML = `
            <a href="/dashboard"
               onclick="window.parent.document.getElementById('homepage-popup').style.display='none';">
              <img src="${imgUrl}" alt="${pod.name || 'Podcast'}">
            </a>
            <p class="episode-count">${pod.open_episodes || 0} Open Episodes</p>
          `;

          podcastList.appendChild(podcastCard);
        });
      })
      .catch((error) => console.error("Error loading podcasts:", error));
  });
</script>
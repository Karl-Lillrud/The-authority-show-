<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='favicon/apple-touch-icon.png') }}">
  <link rel="icon" type="image/png" sizes="192x192" href="{{ url_for('static', filename='favicon/android-chrome-192x192.png') }}">
  <link rel="icon" type="image/png" sizes="512x512" href="{{ url_for('static', filename='favicon/android-chrome-512x512.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon/favicon-32x32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon/favicon-16x16.png') }}">
  <link rel="manifest" href="{{ url_for('static', filename='favicon/site.webmanifest') }}">
  <title>My App</title>
  <!-- Länka till din CSS-fil (justera om nödvändigt) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">
  {% include 'dashboard/components/header.html' %}
  
  <main style="flex: 1;">
    {% block content %}{% endblock %}
  </main>
  
  {% include 'dashboard/components/footer.html' %}
  
  {% if user_email %}
  <script>
    function updateCredits() {
      console.log("updateCredits körs");
      const userEmail = "{{ user_email }}";
      fetch(`/credits?email=${encodeURIComponent(userEmail)}`)
        .then(response => response.json())
        .then(data => {
          console.log("Fetched credits:", data);
          if (data.credits !== undefined) {
            const badge = document.querySelector(".credits-badge span");
            if (badge) {
              badge.textContent = `${data.credits} Credits`;
            }
          } else {
            console.error("❌ Failed to fetch credits!");
          }
        })
        .catch(error => console.error("❌ Error fetching credits:", error));
    }
    document.addEventListener("DOMContentLoaded", updateCredits);
    setInterval(updateCredits, 30000); // Uppdaterar var 30:e sekund
  </script>
  {% endif %}
</body>
</html>

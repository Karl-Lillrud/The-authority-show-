{% extends "dashboard/components/base.html" %}
{% block title %}Podcast Task Management{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/podcastmanagement.css') }}">

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("register-podcast-form");

    form.addEventListener("submit", function (e) {
      e.preventDefault(); // Prevent the form from submitting the traditional way

      // Collect form data
      const podName = document.getElementById("pod-name").value;
      const podRss = document.getElementById("pod-rss").value;
      const podHost = document.getElementById("pod-host").value;
      const guestFormUrl = document.getElementById("guest-form-url").value;
      const facebook = document.getElementById("facebook").value;
      const instagram = document.getElementById("instagram").value;
      const linkedin = document.getElementById("linkedin").value;
      const twitter = document.getElementById("twitter").value;
      const tiktok = document.getElementById("tiktok").value;
      const pinterest = document.getElementById("pinterest").value;
      const website = document.getElementById("website").value;
      const email = document.getElementById("email").value;

      const data = {
        podName,
        podRss,
        podHost,
        guestFormUrl,
        facebook,
        instagram,
        linkedin,
        twitter,
        tiktok,
        pinterest,
        website,
        email,
      };

      // Send data to backend via fetch API
      fetch("/register_podcast", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      })
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            alert(`Error: ${data.error}`);
          } else {
            alert("Podcast registered successfully!");
            window.location.href = data.redirect_url; // Redirect to the production team page
          }
        })
        .catch(error => {
          console.error("Error:", error);
          alert("There was an error with the registration process.");
        });
    });
  });
</script>

</head>
<body>
  <a href="{{ url_for('dashboard_bp.dashboard') }}" class="back-arrow">&#8592; Back</a>
  <div class="container">
    <div class="form-box">
      <div class="form-fields">
        <form id="register-podcast-form">
          <!-- Logo Section -->
          <div class="form-group">
            <label for="pod-logo">Pod Logo</label>
            <div style="display: flex; align-items: center; justify-content: center;">
              <img src="https://podmanagerstorage.blob.core.windows.net/blob-container/pod1.jpg" alt="Pod Logo" class="pod-logo pod-logo-inline" />
            </div>
          </div>

          <!-- Other Fields -->
          <div class="field-group">
            <label for="pod-name">Pod Name</label>
            <input type="text" id="pod-name" required />
          </div>

          <div class="field-group">
            <label for="pod-rss">RSS Feed</label>
            <input type="text" id="pod-rss" required />
          </div>

          <div class="field-group">
            <label for="pod-host">Host(s) Name(s)</label>
            <input type="text" id="pod-host" />
          </div>

          <div class="field-group">
            <label for="guest-form-url">Guest Form URL</label>
            <input type="text" id="guest-form-url" value="https://example.com/guest-form" />
          </div>

          <div class="field-group">
            <label for="facebook">Facebook</label>
            <input type="text" id="facebook" />
          </div>

          <div class="field-group">
            <label for="instagram">Instagram</label>
            <input type="text" id="instagram" />
          </div>

          <div class="field-group">
            <label for="linkedin">LinkedIn</label>
            <input type="text" id="linkedin" />
          </div>

          <div class="field-group">
            <label for="twitter">Twitter</label>
            <input type="text" id="twitter" />
          </div>

          <div class="field-group">
            <label for="tiktok">TikTok</label>
            <input type="text" id="tiktok" />
          </div>

          <div class="field-group">
            <label for="pinterest">Pinterest</label>
            <input type="text" id="pinterest" />
          </div>

          <div class="field-group">
            <label for="website">Website</label>
            <input type="text" id="website" />
          </div>

          <div class="field-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" required />
          </div>

          <button type="submit" class="invite-btn">SAVE</button>
        </form>
      </div>
    </div>
  </div>
{% endblock %}

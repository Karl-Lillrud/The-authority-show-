{% extends "/components/base.html" %}

{% block title %}Publish Episode{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/publish/publish.css') }}">
{% endblock %}

{% block sidebar %}
<!-- Sidebar is intentionally overridden and left empty for the publish page -->
{% endblock %}

{% block content %}
<div class="publish-container">
    <h1 class="page-title">Publish Episode</h1>

    <div class="publish-form-section">
        <div class="field-group">
            <label for="episode-select">Select Episode to Publish:</label>
            <select id="episode-select" name="episode-select">
                <option value="">Loading episodes...</option>
                <!-- Episodes will be populated by JavaScript -->
            </select>
        </div>

        <div id="episode-details-preview" class="episode-details-preview hidden">
            <h3 id="preview-title"></h3>
            <p id="preview-description"></p>
            <img id="preview-image" src="" alt="Episode Image" class="hidden"/>
            <audio id="preview-audio" controls class="hidden"></audio>
        </div>
    </div>

    <div class="publish-form-section">
        <h2>Publishing Platforms</h2>
        <div class="platform-toggles">
            <div class="platform-toggle">
                <input type="checkbox" id="platform-spotify" name="platform-spotify" data-platform="spotify" checked>
                <label for="platform-spotify">
                    <img src="{{ url_for('static', filename='images/platform-icons/spotify.svg') }}" alt="Spotify">
                    Spotify
                </label>
            </div>
            <div class="platform-toggle">
                <input type="checkbox" id="platform-apple" name="platform-apple" data-platform="apple" checked>
                <label for="platform-apple">
                    <img src="{{ url_for('static', filename='images/platform-icons/applepodcasts.svg') }}" alt="Apple Podcasts">
                    Apple Podcasts
                </label>
            </div>
            <div class="platform-toggle">
                <input type="checkbox" id="platform-google" name="platform-google" data-platform="google">
                <label for="platform-google">
                    <img src="{{ url_for('static', filename='images/platform-icons/googlepodcasts.svg') }}" alt="Google Podcasts">
                    Google Podcasts
                </label>
            </div>
            <div class="platform-toggle">
                <input type="checkbox" id="platform-amazon" name="platform-amazon" data-platform="amazon">
                <label for="platform-amazon">
                    <img src="{{ url_for('static', filename='images/platform-icons/amazonmusic.svg') }}" alt="Amazon Music">
                    Amazon Music
                </label>
            </div>
            <div class="platform-toggle">
                <input type="checkbox" id="platform-stitcher" name="platform-stitcher" data-platform="stitcher">
                <label for="platform-stitcher">
                    <img src="{{ url_for('static', filename='images/platform-icons/stitcher.svg') }}" alt="Stitcher">
                    Stitcher
                </label>
            </div>
            <div class="platform-toggle">
                <input type="checkbox" id="platform-pocketcasts" name="platform-pocketcasts" data-platform="pocketcasts">
                <label for="platform-pocketcasts">
                    <img src="{{ url_for('static', filename='images/platform-icons/pocketcasts.svg') }}" alt="Pocket Casts">
                    Pocket Casts
                </label>
            </div>
        </div>
    </div>
    
    <div class="publish-form-section">
        <label for="publish-notes">Publish Notes (Optional):</label>
        <textarea id="publish-notes" name="publish-notes" rows="3" placeholder="Any specific notes for this publish action..."></textarea>
    </div>

    <div class="form-actions">
        <button id="publish-now-btn" class="save-btn">Publish Now</button>
    </div>

    <div id="publish-status" class="publish-status hidden">
        <h3>Publishing Status:</h3>
        <pre id="publish-log"></pre>
    </div>
</div>
{% endblock %}

{% block scripts_extra %}
<script type="module" src="{{ url_for('static', filename='requests/publishRequests.js') }}"></script>
<script type="module" src="{{ url_for('static', filename='js/publish/publish.js') }}"></script>
{% endblock %}
